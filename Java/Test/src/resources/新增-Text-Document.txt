package ncu_project.crypto_analysis_gui;

import javafx.beans.value.ObservableSetValue;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.geometry.HPos;
import javafx.geometry.Pos;
import javafx.scene.control.Button;
import javafx.event.ActionEvent;
import javafx.scene.control.Label;
import javafx.scene.control.ListView;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.HBox;
import javafx.scene.paint.Color;
import javafx.scene.shape.Line;
import javafx.scene.text.TextAlignment;

import java.io.*;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;
import java.util.ResourceBundle;
import java.util.Scanner;

public class MenuController implements Initializable {
    @FXML
    Button current;
    @FXML
    Button history;
    @FXML
    Line current_line;
    @FXML
    Line history_line;
    @FXML
    ListView<AnchorPane> traders;

    public static List<AnchorPane> list_generate(List<String> name_list,List<String> pnl_list,List<String> image_list){
        String name_src;
        String PNL_src;
        String image_src;

        List<AnchorPane> current_list = new ArrayList<>();

        for(int i=0;i<12;i++) {
            name_src = name_list.get(i);
            PNL_src = pnl_list.get(i);
            image_src = image_list.get(i);
            image_src="C:\\Users\\Jason\\IdeaProjects\\Crypto_analysis_GUI\\src\\main\\resources\\ncu_project\\crypto_analysis_gui\\Cat.jpg";

            Label name = new Label(name_src);
            name.setMinWidth(200);
            name.setStyle("-fx-text-fill:white;-fx-alignment:center;");

            Label PNL = new Label(PNL_src);
            PNL.setMinWidth(200);
            PNL.setStyle("-fx-text-fill:white; -fx-alignment:center;");

            ImageView photo = new ImageView(new Image(image_src));
            photo.setFitHeight(40);
            photo.setFitWidth(40);

            Button check = new Button("查看");
            check.setStyle("-fx-background-color:#317a81; -fx-background-radius:6px; -fx-text-fill: white; -fx-padding:1 15 1 15; -fx-font-size: 14px");

            Line dressed_line =new Line(411.0f,10.0f,10.0f,10.0f);
            dressed_line.setStyle("-fx-stroke:white;");
            dressed_line.setOpacity(0.5);


            AnchorPane info = new AnchorPane();
            info.getChildren().add(photo);
            info.getChildren().add(name);
            info.getChildren().add(PNL);
            info.getChildren().add(check);
            info.getChildren().add(dressed_line);
            AnchorPane.setTopAnchor(photo, 5.0);
            AnchorPane.setLeftAnchor(photo,20.0);

            AnchorPane.setTopAnchor(name, 15.0);
            AnchorPane.setLeftAnchor(name,37.7);

            AnchorPane.setTopAnchor(PNL, 15.0);
            AnchorPane.setLeftAnchor(PNL,167.0);

            AnchorPane.setTopAnchor(check, 13.5);
            AnchorPane.setLeftAnchor(check,345.0);

            AnchorPane.setTopAnchor(dressed_line, 53.0);
            AnchorPane.setLeftAnchor(dressed_line,10.0);
            info.setStyle("-fx-background-color: #303030;-fx-border-color:#303030;");

            current_list.add(info);
        }
        //ObservableList<HBox> trader_list = FXCollections.observableArrayList(info_list);
        return current_list;
    }

    @FXML
    private void setCurrent(ActionEvent e){
        traders.getItems().clear();
        current.setOpacity(1.0);
        history.setOpacity(0.5);
        current_line.setVisible(true);
        history_line.setVisible(false);

        List<String> name_list = new ArrayList<>();
        name_list.add("adfadfadfadfadsfa");
        for(int i=1;i<12;i++){
            name_list.add("Jason"+i);
        }
        traders.getItems().addAll(list_generate(name_list,name_list,name_list));
    }

    @FXML
    private void setHistory(ActionEvent e){
        traders.getItems().clear();
        current.setOpacity(0.5);
        history.setOpacity(1.0);
        current_line.setVisible(false);
        history_line.setVisible(true);
        List<String> name_list = new ArrayList<>();
        name_list.add("adfadfadfadfadsfa");
        for(int i=1;i<12;i++){
            name_list.add("history"+i);
        }
        traders.getItems().addAll(list_generate(name_list,name_list,name_list));

    }
    @FXML
    Button setting;

    public List<String> inputfile_read() throws IOException{
        List<String> name1_list = new ArrayList<>();
        FileInputStream fis = new FileInputStream("C:\\Users\\Jason\\PycharmProjects\\traders_info_crawler\\traders_name.txt");
        BufferedReader br = new BufferedReader(new InputStreamReader(fis, "Big5"));
        String oneLine;
        while((oneLine = br.readLine()) != null) {
            name1_list.add(oneLine);
        }
        return name1_list;
    }

    public void initialize(URL location, ResourceBundle resources) {
        List<String> name_list = new ArrayList<>();
        List<String> name1_list=null;
        try {
            name1_list = inputfile_read();
        } catch (IOException e) {
            System.out.println("fail to read.");
        }
        name_list.add("adfadfadfadfa");
        System.out.println(name1_list);
        name_list.add("1");
        for (int i = 2; i < 12; i++) {
            name_list.add("+" + i * 1000 + ".20%");
        }
        traders.getItems().addAll(list_generate(name1_list, name_list, name_list));
    }
}
